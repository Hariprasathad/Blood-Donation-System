{% extends 'layout.html' %}

{% block title %}My Donations - BloodLink{% endblock %}

{% block content %}
<div class="card">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2><i class="fas fa-hand-holding-medical text-primary"></i> My Donations</h2>
        <span class="text-light">Thank you for saving lives!</span>
    </div>

    {% if history %}
    <div class="table-container">
        <table>
            <thead>
                <tr>
                    <th>#</th>
                    <th><i class="fas fa-user-injured"></i> Patient</th>
                    <th><i class="fas fa-droplet"></i> Group</th>
                    <th><i class="fas fa-vial"></i> Units</th>
                    <th><i class="fas fa-comment-dots"></i> Description</th>
                    <th><i class="fas fa-hospital"></i> Location</th>
                    <th><i class="fas fa-phone"></i> Contact</th>
                    <th><i class="fas fa-calendar-check"></i> Fulfilled On</th>
                </tr>
            </thead>
            <tbody>
                {% for h in history %}
                <tr>
                    <td>{{ loop.index }}</td>
                    <td><strong>{{ h.patient_name }}</strong></td>
                    <td><span class="badge badge-warning">{{ h.blood_group }}</span></td>
                    <td>{{ h.units }}</td>
                    <td style="max-width: 250px; font-size: 0.85rem; white-space: pre-line;">{{ h.description }}</td>
                    <td>{{ h.city }}</td>
                    <td>
                        <a href="tel:{{ h.patient_contact }}" class="btn-text text-primary"
                            title="Call Hospital/Patient">
                            <i class="fas fa-phone"></i> {{ h.patient_contact }}
                        </a>
                    </td>
                    <td><small>{{ h.approved_at }}</small></td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <div class="text-center py-5">
        <i class="fas fa-hand-holding-heart fa-3x text-light mb-3"></i>
        <h3 class="text-secondary">No donations yet</h3>
        <p>You haven't accepted any requests yet. Start by checking active requests!</p>
        <a href="{{ url_for('received_request') }}" class="btn btn-primary mt-3">Browse Requests</a>
    </div>
    {% endif %}

    <div style="margin-top: 2rem;">
        <a href="{{ url_for('dashboard') }}" class="btn btn-secondary">
            <i class="fas fa-arrow-left"></i> Back to Dashboard
        </a>
    </div>
</div>
{% endblock %}